<!DOCTYPE html>
<!--
Created using JS Bin
http://jsbin.com

Copyright (c) 2018 by anonymous (http://jsbin.com/tonovozesu/1/edit)

Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html>

<head>
  <meta charset="utf-8">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.js"></script>
  <script>
    mocha.setup('bdd');
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/2.0.0/chai.js"></script>
  <script>
    var assert = chai.assert;
  </script>
</head>

<body>
  <script>
    describe("Hash", function() {
      it("Добавление элемента", function() {
        assert.equal(map.insert(5,13), 1);
      });
      
      it("Добавление элемента с коллизией", function() {
        assert.equal(map.insert(80,7), 1);
      });
      
      it("Удаление элемента", function() {
        assert.equal(map.del(5,13), 1);
      });
      
       it("Добавление элемента", function() {
        assert.equal(map.insert(30,900), 1);
      });
      
      it("Удаление элемента с коллизией", function() {
        assert.equal(map.del(80), 1);
      });
      
      it("Поиск элемента", function() {
        assert.equal(map.find(80),-1);
      });
    
     });
  </script>

  <div id="mocha"></div>

  <script>
    mocha.run();
  </script>
<script id="jsbin-javascript">
var map = {
  size: 25,
  arr: Array(25),
  
  hashCode: function(key){
    return key % this.size;
  },
  
  insert: function(key, value){
    var index = this.hashCode(key);
    
    if (this.arr[index] == undefined)
      this.arr[index] = {key: key, value: value};
    else {
      var newIndex = index;
      while (this.arr[newIndex] != undefined){
        if (this.arr[newIndex].key == key)
          return -1;
        newIndex++;
        if (newIndex == index)
          return -1;
        if (newIndex == this.size)
          newIndex = 0;
      }
      this.arr[newIndex] = {key: key, value: value};
    }
    
    return 1;
  },
  
  find: function(key){
    var index = this.hashCode(key);
    
    if (this.arr[index] == undefined)
      return -1;
    
    if (this.arr[index].key === key)
      return this.arr[index].value;
    
    var newIndex = index;
    newIndex++;
    while (this.arr[newIndex] != undefined && newIndex != index){
      if (this.arr[newIndex].key == key)
        return this.arr[newIndex].value;
      if (newIndex == this.size)
        newIndex = 0;
      newIndex++;
    }
    return -1;
  },
  
  del: function(key){
    var index = this.hashCode(key);
    
    if (this.arr[index] == undefined || this.arr[index].key != key){
      var newIndex = index;
      newIndex++;
      while (this.arr[newIndex] != undefined && newIndex != index){
        if (this.arr[newIndex].key == key){
          this.arr[newIndex] = undefined;
          return 1;
        }
        if (newIndex == this.size)
          newIndex = 0;
        newIndex++;
      }
      return -1;
    }
    else
    if (this.arr[index].key === key){
      this.arr[index] = undefined;
      return 1;
    }
  }
}
</script>
</body>

</html>